<?
	include "global.tbh"
	declare it_was_save as no_yes
	dim flag as ok_ng
?>

<html dir="rtl" lang="heb">
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1255">
<META HTTP-EQUIV="Content-language" CONTENT="he"> 
<meta http-equiv="cache-control" content="private">
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE, NO-STORE">
<link rel="stylesheet" type="text/css" href="official.css">
<link rel="stylesheet" type="text/css" href="tpp_demo.css" />

<style type="text/css">
td.disabled
{
background-color:#808080;
} 

</style>

<script type="text/javascript">



var timepicker;
var read_time;
var flag;
var Entry;

function changeImage1() {
		element=document.getElementById('myimage')
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
		var xmlhttp=new XMLHttpRequest();
		}
		else
		{// code for IE6, IE5
		var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}

			xmlhttp.onreadystatechange=function()   {
			if (xmlhttp.readyState==4 && xmlhttp.status==200) {				
				var s=xmlhttp.responseText;
					element.src="pic_bulboff.gif";	
				}
		}

		//use random to avoid caching
		xmlhttp.open("GET","command.html?command=" + "Cls" + Math.random(),true);
		xmlhttp.send();
	}

function changeImage2() {
		element=document.getElementById('myimage')
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
		var xmlhttp=new XMLHttpRequest();
		}
		else
		{// code for IE6, IE5
		var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}

			xmlhttp.onreadystatechange=function()   {
			if (xmlhttp.readyState==4 && xmlhttp.status==200) {				
					element.src="pic_bulbon.gif";	
				}
		}

		//use random to avoid caching
		xmlhttp.open("GET","command.html?command=" + "Opn" + Math.random(),true);
		xmlhttp.send();
	}


function ReadImage() {
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
		var xmlhttp=new XMLHttpRequest();
		}
		else
		{// code for IE6, IE5
		var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}
			xmlhttp.onreadystatechange=function()   {
			if (xmlhttp.readyState==4 && xmlhttp.status==200) {				
					var s =  xmlhttp.responseText;
				if(s==1) {
					element=document.getElementById('myimage');
					element.src="pic_bulbon.gif";	
			
					} else {
					element=document.getElementById('myimage');
					element.src="pic_bulboff.gif";	
				
					}					
				}
		}

		//use random to avoid caching
		xmlhttp.open("GET","command.html?command=" + "RIH31" + Math.random(),true);
		xmlhttp.send();
	}




function sleep(milliseconds) {
  var start = new Date().getTime();
  for (var i = 0; i < 1e7; i++) {
    if ((new Date().getTime() - start) > milliseconds){
      break;
    }
  }
}




//========================================










function ftime(){
timepicker = document.getElementById('time_val').value;
}




var xmlhttp;
var t;

function IndexPage()
{
	window.top.location.replace("Index.html")
}

function UT3(socket_num)
{
clearTimeout(t);
if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	} 
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
  
	xmlhttp.onreadystatechange=function()
	{
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{
			if (xmlhttp.responseText=="INVALID SESSION ID")
			{
				IndexPage();
			}
			else
			{
				var a=xmlhttp.responseText;
				var y;
				var k;
				var j;
				var i;
				
<?#if PLATFORM_ID=TPP3W?>	
				switch(socket_num)
				{
				case "K1":
					j=0;
					break;
				case "K5":
					j=8;	
					break;
				case "K9":
					j=16;
					break;
				case "K13":
					j=24;
				}				

<?#endif?>
<?#if PLATFORM_ID=TPP2W?>
				switch(socket_num)
				{
				case "K1":
					j=0;
					break;
				case "K3":
					j=4;	
					break;
				case "K5":
					j=8;
					break;
				case "K7":
					j=12;
				}	

<?#endif?>

				if (a.charAt(0)=="0")
				{
					for(i=j;i<j+2;i++)
					{
						y="a"+i.toString();
						k=document.getElementById(y);
						k.disabled=false;
						y="b"+i.toString();
						k=document.getElementById(y);
						k.disabled=false;
					}
				}
				else
				{
					for(i=j;i<j+2;i++)
					{
						y="a"+i.toString();
						k=document.getElementById(y);
						k.disabled=true;
						y="b"+i.toString();
						k=document.getElementById(y);
						k.disabled=true;
					}				
				}
				
				j=j+2;
				if (a.charAt(0)=="0"||a.charAt(1)=="0")
				{
					for(i=j;i<j+2;i++)
					{
						y="a"+i.toString();
						k=document.getElementById(y);
						k.disabled=false;
						y="b"+i.toString();
						k=document.getElementById(y);
						k.disabled=false;
					}				
				}
				else
				{
					for(i=j;i<j+2;i++)
					{
						y="a"+i.toString();
						k=document.getElementById(y);
						k.disabled=true;
						y="b"+i.toString();
						k=document.getElementById(y);
						k.disabled=true;

					}				
				}	
			}
		}
	}
	var x=document.getElementById(socket_num);
	xmlhttp.open("GET","q.html?session=<?sock_setsend(login_data)?>&i="+x.id+"&s="+x.value+"&q="+Math.random(),true);
	xmlhttp.send();	
	x.blur();
}

function RT()
{
	clearTimeout(t);
	t=setTimeout("UT()",2000);
}

function UT2(io_num)
{
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	} 
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
  
	xmlhttp.onreadystatechange=function()
	{
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{
			if (xmlhttp.responseText=="INVALID SESSION ID")
			{
				IndexPage();	
			}
			else
			{	
				var a=xmlhttp.responseText;
				var y;
				var k;

				y="z"+io_num.substr(1);
				switch(a)
				{
				case "0":
					k="<table><tr><td width='24' bgcolor='red' align='center'><font color='white'> L </font></td></tr></table>";
					break;
				case "1":
					k="<table><tr><td width='24' bgcolor='green' align='center'><font color='white'> H </font></td></tr></table>";			
					break;
				default:
					k="<table><tr><td width='24' bgcolor='grey' align='center'><br></td></tr></table>";
				}
				document.getElementById(y).innerHTML=k;
			}
		}
	}

	var x=document.getElementById(io_num);
	if (x.checked==true)
	{
		xmlhttp.open("GET","q.html?session=<?sock_setsend(login_data)?>&i="+x.id+"&s=1&q="+Math.random(),true);
	}
	else
	{
		xmlhttp.open("GET","q.html?session=<?sock_setsend(login_data)?>&i="+x.id+"&s=0&q="+Math.random(),true);
	}
	xmlhttp.send();	
}

function UT()
{	
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	} 
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
  
	xmlhttp.onreadystatechange=function()
	{
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{
			if (xmlhttp.responseText=="INVALID SESSION ID")
			{
				IndexPage();	
			}
			else
			{	
				var x=xmlhttp.responseText;
				var i;
				var y;
				var k;
				var w;
				var j=<?sock_setsend(NUM_OF_IO)?>;
				for (i=0;i<j;i++)
				{
					y="z"+i.toString();

					switch(x.charAt(i))
					{
					case "0":
						k="<table><tr><td width='24' bgcolor='red' align='center'><font color='white'> L </font></td></tr></table>";
						break;
					case "1":
						k="<table><tr><td width='24' bgcolor='green' align='center'><font color='white'> H </font></td></tr></table>";			
						break;
					default:
						k="<table><tr><td width='24' bgcolor='grey' align='center'><br></td></tr></table>";
					}
					document.getElementById(y).innerHTML=k;
				}
				
				for (i=0;i<j;i++)
				{
					y="a"+i.toString();
					w=document.getElementById(y);
					switch(x.charAt(i+j))
					{
					case "0":
						w.checked=false;
						break;
					case "1":
						w.checked=true;			
						break;
					}
				}
			
				for (i=0;i<j;i++)
				{
					y="b"+i.toString();
					w=document.getElementById(y);
					switch(x.charAt(i+j*2))
					{
					case "0":
						w.checked=false;
						break;
					case "1":
						w.checked=true;			
						break;
					}
				}				
			}
		}
	}	
	xmlhttp.open("GET","q.html?session=<?sock_setsend(login_data)?>&q="+Math.random(),true);
	xmlhttp.send();
	clearTimeout(t);
	t=setTimeout("UT()",5000);
}


</script>
</HEAD>

<body <?flag=html_login_verify(yes,yes)
	if flag=OK then sock_setsend(" onload='UT()'")
?>>
	
<? 
	if flag=NG then goto finish
?>
<div>
<br>


</div>
<?finish:

?>



<table border="0" align='center' width='100%'>
	<tr>
		<td width='50%' align='left'>Version: 10.10.2014</td>
	</tr>
</table>

<!--
<form action="config.html" method="get">
<input type="submit" value="Setting">
</form>
-->

</h1>

<h1 align='center'> IDP Israel Relay Control


</h1>

<table border="5" align='center' CELLPADDING="4" CELLSPACING="3" style="border-radius:12px; border-color:#3071b8">
<tr><td>

<form align='center' id='relayForm'>

<table border="0" align='center'>

<tr>
<td><input id='relayValue1' type="button"  onclick='changeImage2()' name='RL1' value="On" class="input-rounded-button-green" style="width: 200px; height: 60px; border: 5px solid #000000; font-size:200%"></td>
<td><input id='relayValue3' type='hidden' name='RL2' value='3'><img id="myimage" src="pic_bulboff.gif" width="100" height="180"></td>
<td><input id='relayValue1' type="button"  onclick='changeImage1()' name='RL1' value="Off"  class="input-rounded-button-red" style="width: 200px; height: 60px; border: 5px solid #000000; font-size:200%" ></td>
</tr>
<tr>
<td colspan="3">
<input type="button" id='relayValue4' onclick='ReadImage()' type='hidden' name='RL4' value="Press to get the latest relay status" class="input-rounded-button-white" style="width: 500px; height: 60px; background-color: azure; border: 5px solid #000000; font-size:200%">

</tr>
</td>
</table>
</form>

<br>


<hr>
<p align='center'>For more information about this product, please contact IDP Israel +972-3-5617395 <a target='_blank' href='http://www.idp.co.il'>www.idp.co.il</a></p>
</body>


</html>
